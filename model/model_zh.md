# 车辆路径问题（VRP）模型 — 中文版

本文件描述本仓库使用的混合整数规划（MIP）模型。

符号说明
- V：节点集合；0 表示仓库（depot）。
- C：客户集合（V \ {0}）。
- K：车辆集合。

变量
- x_{i,j,k} ∈ {0,1}：若车辆 k 从 i 到 j 则为 1。
- y_k ∈ {0,1}：若车辆 k 被启用则为 1。
- a_i ≥ 0：节点 i 的到达时间。
- u_{i,k} ≥ 0：车辆 k 在访问 i 后的载重。
- δ^+_i, δ^-_i ≥ 0：时间窗早到/迟到松弛变量。
- z_i ∈ {0,1}：客户 i 是否被服务（1 表示服务）。

参数
- d_{i,j}：节点 i, j 之间距离。
- c^k_{i,j}：车辆 k 在弧 (i,j) 的单位距离成本。
- f_k：车辆 k 的固定启用成本。
- Q_k：车辆 k 的载重能力。
- q_i：客户 i 的需求量。
- s_i：节点 i 的服务时间。
- [e_i, l_i]：节点 i 的时间窗。
- β、γ：早到/迟到的单位惩罚。
- λ_i：客户未被服务的惩罚（或权重）。
- 权重：w_fixed、w_distance、w_early、w_late、w_unserved。

目标函数
最小化：

w_fixed * sum_k f_k y_k + w_distance * sum_{k,i!=j} c^k_{i,j} d_{i,j} x_{i,j,k} + w_early * β * sum_i δ^+_i + w_late * γ * sum_i δ^-_i - w_unserved * sum_i λ_i z_i

约束
1. 车辆始发/返回仓库：对每个 k， sum_j x_{0,j,k} = y_k， sum_j x_{j,0,k} = y_k。
2. 客户访问等于 z_i：对每个客户 i， sum_{k,j} x_{j,i,k} = z_i。
3. 流守恒：对每个 k 和节点 i，入流 = 出流。
4. 载重传播（Big-M 示例）：
   u_{j,k} ≥ u_{i,k} + q_j z_j - M(1 - x_{i,j,k})，u_{0,k} = 0，且 0 ≤ u_{i,k} ≤ Q_k。
5. 时间窗（Big-M 软约束）：
   a_j ≥ a_i + s_i + travel_time_{i,j} - M(1 - x_{i,j,k})；
   a_i - δ^+_i ≥ e_i； a_i + δ^-_i ≤ l_i。
6. 变量域：x,y,z 二元；a,u,δ 连续且非负。

说明
- Big-M 的选择要谨慎，过大可能导致数值不稳定。
- 允许客户未被服务（z_i = 0），通过 λ_i 与 w_unserved 控制激励/惩罚。
- 可将模型导出为 CSR 格式（变量列表、类型、界、约束矩阵）以提交给远程求解服务。

---

建议：先在小规模实例上验证模型与 M 的选择，再扩展到大规模实验。
